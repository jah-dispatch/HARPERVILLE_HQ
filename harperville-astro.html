<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Harperville‚Ñ¢ | Astrology Portal</title>

  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    .astro-wrap { max-width: 900px; margin: 0 auto; }
    .astro-cardish { border: 1px solid rgba(255,255,255,0.15); border-radius: 12px; padding: 1.25rem; background: rgba(0,0,0,0.20); }
    .astro-grid { display: grid; gap: 1rem; grid-template-columns: repeat(12, 1fr); }
    .astro-col-6 { grid-column: span 6; }
    .astro-col-12 { grid-column: span 12; }
    .astro-label { display:block; margin-bottom:.35rem; opacity:.9; }
    .astro-input, .astro-select {
      width: 100%;
      padding: .75rem .85rem;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(0,0,0,0.25);
      color: inherit;
      outline: none;
    }
    .astro-row { display:flex; gap:.75rem; align-items:center; flex-wrap: wrap; }
    .astro-btn {
      border: 1px solid var(--oz-gold);
      background: rgba(255, 215, 0, 0.07);
      color: inherit;
      padding: .75rem 1rem;
      border-radius: 10px;
      cursor: pointer;
    }
    .astro-btn:hover { background: rgba(255, 215, 0, 0.12); box-shadow: 0 0 18px rgba(255, 215, 0, 0.18); }
    .astro-small { font-size: .92rem; opacity: .85; line-height: 1.35; }
    .astro-results { display:none; margin-top: 1rem; }
    .astro-results.open { display:block; }
    .astro-kv { display:grid; grid-template-columns: 160px 1fr; gap:.5rem 1rem; }
    .astro-kv div { padding:.25rem 0; }
    .astro-pill { display:inline-block; border:1px solid rgba(255,215,0,0.35); padding:.25rem .6rem; border-radius:999px; margin-right:.35rem; margin-top:.35rem; }
    @media (max-width: 760px){
      .astro-col-6 { grid-column: span 12; }
      .astro-kv { grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <main class="dashboard-container">
    <header class="dashboard-header">
      <h2 class="system-status">SYSTEM: <span class="highlight">ASTROLOGY ONLINE</span></h2>
      <a href="mainframe.html" class="exit-link"><i class="fa-solid fa-arrow-left"></i> RETURN TO MAINFRAME</a>
    </header>

    <section class="bio-container astro-wrap">
      <h1 class="bio-title"><span class="gold-pulse">HARPERVILLE ASTRO PORTAL</span></h1>
      <p class="bio-text">
        Enter your birth data to generate a natal chart on a trusted chart engine, then return here for Ivy Willow‚Äôs weekly transit briefing.
      </p>

      <div class="astro-cardish">
        <h3 class="bio-title" style="margin-top:0;">1) Birth data input</h3>

        <form id="astro-form" class="astro-grid" autocomplete="on">
          <div class="astro-col-6">
            <label class="astro-label" for="birth-date">Birthday</label>
            <input class="astro-input" id="birth-date" name="birth-date" type="date" required />
          </div>

          <div class="astro-col-6">
            <label class="astro-label" for="birth-time">Time of birth</label>
            <div class="astro-row">
              <input class="astro-input" id="birth-time" name="birth-time" type="time" />
              <label class="astro-small">
                <input id="time-unknown" type="checkbox" />
                Time unknown (use noon)
              </label>
            </div>
            <div class="astro-small">If you don‚Äôt know the time, noon is a common approximation. Rising/house accuracy may vary.</div>
          </div>

          <div class="astro-col-12">
            <label class="astro-label" for="birth-place">Place of birth</label>
            <input class="astro-input" id="birth-place" name="birth-place" type="text" placeholder="City, State/Region, Country (e.g., Grand Junction, CO, USA)" required />
            <div class="astro-small">Tip: use the most official spelling your birthplace uses.</div>
          </div>

          <div class="astro-col-12">
            <div class="astro-row">
              <button class="astro-btn" type="submit">
                <i class="fa-solid fa-chart-pie"></i> Generate chart link
              </button>

              <button class="astro-btn" type="button" id="copy-summary">
                <i class="fa-solid fa-copy"></i> Copy my birth data
              </button>
            </div>
          </div>
        </form>

        <div id="astro-results" class="astro-results">
          <h3 class="bio-title">2) Your generated links</h3>
          <p class="astro-small">
            Use the link below to generate your natal chart on a leading chart site. After you‚Äôve got your placements, paste the ‚ÄúBig Three‚Äù back into Harperville for the fun part.
          </p>

          <div class="astro-kv">
            <div><strong>Chart link</strong></div>
            <div><a id="chart-link" href="#" target="_blank" rel="noopener">Open chart generator</a></div>
<p class="astro-small" style="margin-top: 0.5rem;">
  üêæ Your chart opens on Astro‚ÄëSeek in a new tab. Return here to translate the cosmos into meaning.
</p>

            <div><strong>Birth data</strong></div>
            <div id="birth-summary"></div>
          </div>

          <div style="margin-top:.75rem;">
            <span class="astro-pill">Sun</span>
            <span class="astro-pill">Moon</span>
            <span class="astro-pill">Rising</span>
            <span class="astro-pill">Mercury</span>
            <span class="astro-pill">Venus</span>
            <span class="astro-pill">Mars</span>
          </div>
<div class="astro-cardish" style="margin-top:1rem;">
  <h3 class="bio-title">Your Big Three</h3>

  <div class="astro-grid">
    <div class="astro-col-4">
      <label class="astro-label">Sun Sign</label>
      <input class="astro-input" id="sun-sign" placeholder="e.g., Taurus">
    </div>

    <div class="astro-col-4">
      <label class="astro-label">Moon Sign</label>
      <input class="astro-input" id="moon-sign" placeholder="e.g., Cancer">
    </div>

    <div class="astro-col-4">
      <label class="astro-label">Rising Sign</label>
      <input class="astro-input" id="rising-sign" placeholder="e.g., Leo">
    </div>
  </div>
</div>

<div class="astro-cardish" style="margin-top:1rem;">
  <h3 class="bio-title">Ivy Willow‚Äôs Weekly Briefing</h3>

  <div id="ivy-briefing" class="astro-small">
    Enter your Sun, Moon, and Rising above to receive Ivy Willow‚Äôs guidance.
  </div>

  <button class="astro-btn" id="generate-briefing" style="margin-top:.75rem;">
    Generate Weekly Briefing
  </button>
</div>

          <p class="astro-small" style="margin-top:1rem;">
            Next phase: We‚Äôll pull natal + transits directly via an API so Harperville generates the weekly forecast automatically.
          </p>
        </div>
      </div>

      <div class="astro-cardish" style="margin-top:1rem;">
        <h3 class="bio-title" style="margin-top:0;">3) Weekly transit briefing</h3>
        <p class="astro-small">
          Coming online next: a personalized weekly forecast based on your natal chart + current transits. For now, this portal is building the foundation and making the process effortless.
        </p>
      </div>
    </section>
  </main>

  <script>
  // =========================
  // Core DOM References
  // =========================
  const form = document.getElementById('astro-form');
  const timeUnknown = document.getElementById('time-unknown');
  const birthTime = document.getElementById('birth-time');
  const results = document.getElementById('astro-results');
  const chartLink = document.getElementById('chart-link');
  const birthSummary = document.getElementById('birth-summary');
  const copyBtn = document.getElementById('copy-summary');

  const sunInput = document.getElementById("sun-sign");
  const moonInput = document.getElementById("moon-sign");
  const risingInput = document.getElementById("rising-sign");
  const ivyBriefing = document.getElementById("ivy-briefing");
  const clearBig3Btn = document.getElementById("clear-big3");

  const HV_BIG3_KEY = "harperville_astro_big3";

  // =========================
  // Time Unknown Toggle
  // =========================
  timeUnknown.addEventListener('change', () => {
    if (timeUnknown.checked) {
      birthTime.value = '12:00';
      birthTime.setAttribute('disabled', 'disabled');
    } else {
      birthTime.removeAttribute('disabled');
      birthTime.value = '';
    }
  });

  // =========================
  // Utility Functions
  // =========================
  function summaryText({ date, time, place }) {
    return `Birthday: ${date}\nTime: ${time || 'Unknown'}\nPlace: ${place}`;
  }

  function getBig3() {
    return {
      sun: (sunInput?.value || "").trim(),
      moon: (moonInput?.value || "").trim(),
      rising: (risingInput?.value || "").trim(),
      savedAt: new Date().toISOString()
    };
  }

  function saveBig3() {
    localStorage.setItem(HV_BIG3_KEY, JSON.stringify(getBig3()));
  }

  function loadBig3() {
    const raw = localStorage.getItem(HV_BIG3_KEY);
    if (!raw) return null;
    try {
      return JSON.parse(raw);
    } catch {
      return null;
    }
  }

  // =========================
  // Auto‚ÄëLoad Big Three
  // =========================
  const savedBig3 = loadBig3();
  if (savedBig3) {
    if (sunInput) sunInput.value = savedBig3.sun || "";
    if (moonInput) moonInput.value = savedBig3.moon || "";
    if (risingInput) risingInput.value = savedBig3.rising || "";

    if (ivyBriefing) {
      ivyBriefing.textContent =
        `Saved chart detected: Sun ${savedBig3.sun || "?"}, Moon ${savedBig3.moon || "?"}, Rising ${savedBig3.rising || "?"}. Ivy Willow is on standby.`;
    }
  }

  // =========================
  // Auto‚ÄëSave on Input
  // =========================
  [sunInput, moonInput, risingInput].forEach(el => {
    if (!el) return;
    el.addEventListener("input", saveBig3);
    el.addEventListener("change", saveBig3);
  });

  // =========================
  // Birth Chart Generator
  // =========================
  form.addEventListener('submit', (e) => {
    e.preventDefault();

    const date = document.getElementById('birth-date').value;
    const time = document.getElementById('birth-time').value || (timeUnknown.checked ? '12:00' : '');
    const place = document.getElementById('birth-place').value.trim();

    const [year, month, day] = date.split("-");
    const safeTime = time || "12:00";
    const [hour, minute] = safeTime.split(":");

    const url =
      `https://horoscopes.astro-seek.com/birth-chart-horoscope-online` +
      `?narozeni_den=${day}` +
      `&narozeni_mesic=${month}` +
      `&narozeni_rok=${year}` +
      `&narozeni_hodina=${hour}` +
      `&narozeni_minuta=${minute}` +
      `&narozeni_mesto_hidden=${encodeURIComponent(place)}` +
      `&house_system=placidus` +
      `&zverokruh=tropical` +
      `&tolerance=1`;

    chartLink.href = url;
    chartLink.textContent = 'Open natal chart generator';

    birthSummary.textContent = summaryText({ date, time: time || 'Unknown', place });
    results.classList.add('open');
    results.scrollIntoView({ behavior: 'smooth', block: 'start' });
  });

  // =========================
  // Copy Birth Data
  // =========================
  copyBtn.addEventListener('click', async () => {
    const date = document.getElementById('birth-date').value;
    const time = document.getElementById('birth-time').value || (timeUnknown.checked ? '12:00' : 'Unknown');
    const place = document.getElementById('birth-place').value.trim() || 'Unknown';

    const text = summaryText({ date: date || 'Unknown', time, place });
    try {
      await navigator.clipboard.writeText(text);
      copyBtn.innerHTML = '<i class="fa-solid fa-check"></i> Copied';
      setTimeout(() => {
        copyBtn.innerHTML = '<i class="fa-solid fa-copy"></i> Copy my birth data';
      }, 1200);
    } catch {
      alert(text);
    }
  });

  // =========================
  // Ivy Willow Weekly Briefing
  // =========================
  document.getElementById("generate-briefing").addEventListener("click", () => {
    saveBig3();

    const sun = sunInput.value;
    const moon = moonInput.value;
    const rising = risingInput.value;

    if (!sun || !moon || !rising) {
      ivyBriefing.textContent =
        "Ivy Willow requires all three signs to proceed.";
      return;
    }

    ivyBriefing.textContent =
      `With ${sun} grounding your core, ${moon} guiding your emotional weather, and ${rising} shaping how the world meets you, this week favors intentional pacing. Choose presence over urgency. Ivy Willow suggests fewer promises ‚Äî and deeper follow‚Äëthrough.`;
  });

  // =========================
  // Clear Big Three
  // =========================
  if (clearBig3Btn) {
    clearBig3Btn.addEventListener("click", () => {
      localStorage.removeItem(HV_BIG3_KEY);

      sunInput.value = "";
      moonInput.value = "";
      risingInput.value = "";

      ivyBriefing.textContent =
        "Big Three cleared. Ivy Willow awaits fresh coordinates.";
    });
  }
</script>

</body>
</html>
